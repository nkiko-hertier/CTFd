<!-- Modern Tabler-style theme switcher component -->
<div class="dropdown" x-data="ThemeSwitcher">
  <button 
    class="btn btn-ghost-secondary btn-icon" 
    type="button" 
    data-bs-toggle="dropdown" 
    aria-expanded="false"
    :title="currentTheme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'"
  >
    <i class="fas fa-sun" x-show="currentTheme === 'dark'"></i>
    <i class="fas fa-moon" x-show="currentTheme === 'light'"></i>
    <i class="fas fa-desktop" x-show="currentTheme === 'auto'"></i>
  </button>
  
  <ul class="dropdown-menu dropdown-menu-end">
    <li>
      <button 
        class="dropdown-item d-flex align-items-center" 
        @click="setTheme('light')"
        :class="{ 'active': currentTheme === 'light' }"
      >
        <i class="fas fa-sun me-2"></i>
        {% trans %}Light{% endtrans %}
        <i class="fas fa-check ms-auto" x-show="currentTheme === 'light'"></i>
      </button>
    </li>
    <li>
      <button 
        class="dropdown-item d-flex align-items-center" 
        @click="setTheme('dark')"
        :class="{ 'active': currentTheme === 'dark' }"
      >
        <i class="fas fa-moon me-2"></i>
        {% trans %}Dark{% endtrans %}
        <i class="fas fa-check ms-auto" x-show="currentTheme === 'dark'"></i>
      </button>
    </li>
    <li>
      <button 
        class="dropdown-item d-flex align-items-center" 
        @click="setTheme('auto')"
        :class="{ 'active': currentTheme === 'auto' }"
      >
        <i class="fas fa-desktop me-2"></i>
        {% trans %}System{% endtrans %}
        <i class="fas fa-check ms-auto" x-show="currentTheme === 'auto'"></i>
      </button>
    </li>
  </ul>
</div>

<script>
document.addEventListener('alpine:init', () => {
  Alpine.data('ThemeSwitcher', () => ({
    currentTheme: 'auto',
    
    init() {
      // Get saved theme or default to auto
      this.currentTheme = localStorage.getItem('theme') || 'auto';
      this.applyTheme();
      
      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
        if (this.currentTheme === 'auto') {
          this.applyTheme();
        }
      });
    },
    
    setTheme(theme) {
      this.currentTheme = theme;
      localStorage.setItem('theme', theme);
      this.applyTheme();
    },
    
    applyTheme() {
      const html = document.documentElement;
      
      if (this.currentTheme === 'dark') {
        html.setAttribute('data-bs-theme', 'dark');
        html.classList.add('dark');
      } else if (this.currentTheme === 'light') {
        html.setAttribute('data-bs-theme', 'light');
        html.classList.remove('dark');
      } else {
        // Auto mode - follow system preference
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        html.setAttribute('data-bs-theme', prefersDark ? 'dark' : 'light');
        html.classList.toggle('dark', prefersDark);
      }
    }
  }));
});
</script>
